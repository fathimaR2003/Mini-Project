<div class="signup-container">
    <div class="signup-box">
        <h2>Create Your Account</h2>
        <p class="subtitle">Create Your Account</p>
        {{#if errmsg}}
        <p class="error">{{errmsg}}</p>
        {{/if}}

        <form class="mt-5" action="/signup" method="post" enctype="multipart/form-data">
            <!-- Name & Email -->
            <div style="display: flex; gap: 6px;">
                <div class="input-group">
                    <img src="/design/person_icon.svg" alt="User Icon">
                    <input class="ml-2" name="name" type="text" placeholder="Enter Name" required>
                </div>

                <div class="input-group">
                    <img src="/design/mail_icon.svg" alt="Mail Icon">
                    <input class="ml-2" name="email" type="email" placeholder="Email Address" required autocomplete="off">
                </div>
            </div>

            <!-- Password -->
            <div class="input-group">
                <img src="/design/lock_icon.svg" alt="Lock Icon">
                <input class="ml-2" name="password" type="password" placeholder="Password" required>
            </div>

            <!-- Phone -->
            <div class="input-group">
                <input name="ph" id="phoneNumber" type="tel" placeholder="Phone Number" {{!(10 digits)" required pattern="[6-9][0-9]{9}"}} maxlength="10">
            </div>
            <p id="phoneError" class="error-message" style="display: none; color: #ef4444; font-size: 12px; margin-top: -10px; margin-bottom: 10px; text-align: left;">{{!Please enter a valid 10-digit mobile number starting with 6-9}}</p>

            <!-- Address -->
            <div class="input-group">
                <textarea name="address" placeholder="Enter Address with Pincode" required></textarea>
            </div>

            <!-- District Selection & Location -->
            <div style="display: flex; gap: 8px;">
                <div class="input-group">
                    <select name="district" required>
                        <option value="" disabled selected>Choose Your District</option>
                        <option value="alappuzha">Alappuzha</option>
                        <option value="ernakulam">Ernakulam</option>
                        <option value="idukki">Idukki</option>
                        <option value="kannur">Kannur</option>
                        <option value="kasaragod">Kasaragod</option>
                        <option value="kollam">Kollam</option>
                        <option value="kottayam">Kottayam</option>
                        <option value="kozhikode">Kozhikode</option>
                        <option value="malappuram">Malappuram</option>
                        <option value="palakkad">Palakkad</option>
                        <option value="pathanamthitta">Pathanamthitta</option>
                        <option value="thiruvananthapuram">Thiruvananthapuram</option>
                        <option value="thrissur">Thrissur</option>
                        <option value="wayanad">Wayanad</option>
                    </select>
                </div>

                <div class="location-group">
                    <button type="button" onclick="getUserLocation()">Get Location</button>
                    <input name="late" type="text" id="late" hidden>
                    <input name="long" type="text" id="long" hidden>
                </div>
            </div>

            <!-- Already Have an Account -->
            <p class="signup-link">Already have an account? <a href="/login">Login</a></p>

            <!-- Submit -->
            <button type="submit">Submit</button>
        </form>
    </div>
</div>

<!-- CSS -->
<style>
    /* Background */
    .signup-container {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        background: linear-gradient(to bottom right, #bfdbfe, #c084fc);
        padding: 20px;
    }

    /* Signup Box */
    .signup-box {
        width: 100%;
        max-width: 400px;
        background: #0f172a;
        color: #a5b4fc;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        text-align: center;
          animation: flipIn 1.3s ease-in-out forwards;
    }

    /* Headings */
    h2 {
        font-size: 24px;
        font-weight: bold;
        color: #fff;
    }

    /* Error Message */
    .error {
        color: red;
        font-size: 14px;
        margin-bottom: 10px;
    }

    /* Input Group */
    .input-group {
        display: flex;
        align-items: center;
        background-color: #1e293b;
        padding: 12px;
        border-radius: 20px;
        margin-bottom: 15px;
        flex: 1;
    }

    .input-group input,
    .input-group textarea,
    .input-group select {
        flex: 1;
        background: transparent !important;
        border: none;
        outline: none;
        color: #a5b4fc;
        font-size: 14px;
        padding: 5px;
        min-width: 0;
        appearance: none;
    }

    /* Email Fix */
    .input-group input[name="email"] {
        width: 50%;
        position: relative;
        z-index: 10;
    }
     .input-group input[name="name"] {
        width: 50%;
        position: relative;
        z-index: 10;
    }

    /* Placeholder */
    .input-group input::placeholder,
    .input-group textarea::placeholder {
        color: #a5b4fc;
        opacity: 0.7;
    }

    /* Dropdown */
    .input-group select {
        background: transparent;
        border: none;
        color: #a5b4fc;
        font-size: 14px;
    }

    /* Location Button */
    .location-group {
        display: flex;
        justify-content: center;
        margin-bottom: 15px;
    }

    .location-group button {
        padding: 8px 15px;
        border: none;
        background: #6366f1;
        color: white;
        border-radius: 20px;
        cursor: pointer;
    }

    /* Signup Link */
    .signup-link {
        margin-top: 15px;
        font-size: 14px;
    }

    .signup-link a {
        color: #a5b4fc;
        font-weight: bold;
    }

    /* Submit Button */
    button {
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 20px;
        background: linear-gradient(to bottom right, #6366f1, #312e81);
        color: white;
        font-size: 16px;
        cursor: pointer;
        transition: 0.3s;
    }

    /* Autofill Fix */
    .input-group input:-webkit-autofill,
    .input-group input:-webkit-autofill:hover,
    .input-group input:-webkit-autofill:focus,
    .input-group input:-webkit-autofill:active {
        -webkit-box-shadow: 0 0 0px 1000px #1e293b inset !important;
        -webkit-text-fill-color: #a5b4fc !important;
        transition: background-color 5000s ease-in-out 0s;
    }
    

    @keyframes flipIn {
        0% {
            opacity: 0;
            transform: perspective(600px) rotateX(-90deg);
        }

        100% {
            opacity: 1;
            transform: perspective(600px) rotateX(0);
        }
    }
</style>

<!-- Location Script -->
<script>
    function getUserLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    }

    function showPosition(position) {
        document.getElementById("late").value = position.coords.latitude;
        document.getElementById("long").value = position.coords.longitude;
    }

    // Phone Number Validation
    const phoneInput = document.getElementById('phoneNumber');
    const phoneError = document.getElementById('phoneError');
    const form = document.querySelector('form');

    phoneInput.addEventListener('input', function(e) {
        // Remove non-numeric characters
        let value = e.target.value.replace(/\D/g, '');
        
        // Limit to 10 digits
        if (value.length > 10) {
            value = value.slice(0, 10);
        }
        
        e.target.value = value;
        
        // Validate phone number
        validatePhone(value);
    });

    phoneInput.addEventListener('blur', function(e) {
        validatePhone(e.target.value);
    });

    function validatePhone(value) {
        const phoneRegex = /^[6-9][0-9]{9}$/;
        
        if (value.length === 0) {
            phoneError.style.display = 'none';
            phoneInput.setCustomValidity('');
            return;
        }
        
        if (!phoneRegex.test(value)) {
            phoneError.style.display = 'block';
            phoneInput.setCustomValidity('Please enter a valid 10-digit mobile number starting with 6-9');
            phoneInput.style.borderColor = '#ef4444';
        } else {
            phoneError.style.display = 'none';
            phoneInput.setCustomValidity('');
            phoneInput.style.borderColor = '';
        }
    }

    // Form submission validation
    form.addEventListener('submit', function(e) {
        const phoneValue = phoneInput.value;
        const phoneRegex = /^[6-9][0-9]{9}$/;
        
        if (!phoneRegex.test(phoneValue)) {
            e.preventDefault();
            phoneError.style.display = 'block';
            phoneInput.focus();
            alert('Please enter a valid 10-digit mobile number starting with 6-9');
            return false;
        }
    });
</script>
