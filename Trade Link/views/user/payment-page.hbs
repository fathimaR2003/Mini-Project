<style>
    /* ----------------------------------- */
    /* 1. Global & Responsive Styles */
    /* ----------------------------------- */
    .payment-container {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #ffffff;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        width: 100%;
        max-width: 450px;
        margin: 20px auto;
        box-sizing: border-box;
    }

    /* Make sections stack vertically on small screens */
    @media (max-width: 600px) {
        .payment-container {
            margin: 0;
            border-radius: 0;
            max-width: none;
            box-shadow: none;
        }

        .input-row {
            flex-direction: column;
            gap: 0 !important;
        }
    }

    h1 {
        text-align: center;
        color: #1a237e;
        font-size: 1.6em;
        margin-bottom: 15px;
        border-bottom: 2px solid #e0e0e0;
        padding-bottom: 10px;
    }

    .amount-display {
        text-align: center;
        font-size: 1.4em;
        padding: 10px;
        background-color: #e3f2fd;
        color: #1a237e;
        border-radius: 6px;
        margin-bottom: 25px;
        font-weight: bold;
    }

    /* ----------------------------------- */
    /* 2. LIVE CARD DISPLAY STYLES (Restored) */
    /* ----------------------------------- */
    .card-display {
        background: linear-gradient(135deg, #005691, #0077b6);
        /* Blue/Navy Gradient */
        color: white;
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 20px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        height: 230px;
        position: relative;
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .card-type {
        font-weight: bold;
        font-size: 1.1em;
        letter-spacing: 1px;
    }

    .card-chip {
        width: 40px;
        height: 30px;
        background-color: #ffc107;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    #card-number-display {
        font-family: 'Courier New', Courier, monospace;
        font-size: 1.4em;
        letter-spacing: 2px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        margin-bottom: 15px;
    }

    .card-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.9em;
    }

    #card-name-display {
        text-transform: uppercase;
    }

    .visa-logo {
        font-style: italic;
        font-weight: bold;
        font-size: 1.5em;
        color: #fff;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    /* ----------------------------------- */
    /* 3. Payment Method Selector */
    /* ----------------------------------- */
    .method-selector {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        background-color: #f8f8f8;
        padding: 8px;
        border-radius: 8px;
    }

    .method-btn {
        flex: 1;
        padding: 10px 5px;
        border: none;
        background-color: transparent;
        color: #555;
        cursor: pointer;
        font-size: 0.9em;
        font-weight: 600;
        border-radius: 6px;
        transition: all 0.2s;
        margin: 0 4px;
    }

    .method-btn.active {
        background-color: #4caf50;
        color: white;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    /* ----------------------------------- */
    /* 4. Content Sections (Card, UPI, etc.) */
    /* ----------------------------------- */
    .payment-content {
        padding-top: 15px;
    }

    .content-section {
        display: none;
        /* Hidden by default */
        padding: 10px 0;
    }

    .content-section.active {
        display: block;
    }

    .input-group {
        margin-bottom: 15px;
    }

    label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #555;
        font-size: 0.9em;
    }

    input[type="text"],
    input[type="email"],
    select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        box-sizing: border-box;
        font-size: 1em;
    }

    .input-row {
        display: flex;
        gap: 10px;
    }

    .input-row .input-group {
        flex: 1;
    }

    /* UPI Styles */
    .upi-options {
        display: flex;
        justify-content: space-around;
        gap: 10px;
        margin-bottom: 20px;
    }

    .upi-btn {
        flex: 1;
        text-align: center;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
        background-color: #fff;
    }

    .upi-btn.selected {
        border-color: #4caf50;
        box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
        background-color: #e8f5e9;
    }

    .upi-btn img {
        width: 40px;
        height: 40px;
        display: block;
        margin: 0 auto 5px;
    }

    .qr-container {
        text-align: center;
        padding: 15px;
        border: 1px dashed #ccc;
        border-radius: 8px;
        margin-top: 15px;
    }

    .qr-container img {
        width: 150px;
        height: 150px;
        margin-bottom: 10px;
    }

    /* ----------------------------------- */
    /* 5. Pay Button & Modal */
    /* ----------------------------------- */
    .pay-button {
        width: 100%;
        padding: 15px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1.1em;
        cursor: pointer;
        transition: background-color 0.3s;
        font-weight: bold;
        margin-top: 20px;
    }

    .pay-button:hover {
        background-color: #43a047;
    }

    /* Modal/Pop-up Styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        align-items: center;
        justify-content: center;
        display: flex;
    }

    .modal-content {
        background-color: #fefefe;
        padding: 30px;
        width: 90%;
        max-width: 350px;
        border-radius: 10px;
        text-align: center;
        position: relative;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .close-button {
        color: #aaa;
        font-size: 28px;
        font-weight: bold;
        position: absolute;
        top: 10px;
        right: 20px;
        cursor: pointer;
    }

    .success-icon {
        font-size: 4em;
        color: #4caf50;
        line-height: 1;
        margin-bottom: 10px;
    }

    .modal h2 {
        color: #4caf50;
        font-size: 1.5em;
        margin-bottom: 10px;
        border: none;
        padding: 0;
    }

    .modal p {
        color: #555;
        margin-bottom: 20px;
    }
</style>

<div style="width: 100%;height: 104vh;display: flex;justify-content: center;align-items: center;">
    <div class="payment-container">
        <h1>Complete Your Payment</h1>

        <div class="amount-display">
            Amount Payable: **‚Çπ{{price}}**
        </div>

        <div class="method-selector">
            <button class="method-btn active" data-method="card">üí≥ Card</button>
            <button class="method-btn" data-method="upi">üì± UPI</button>
            <button class="method-btn" data-method="netbanking">üè¶ Net Banking</button>
        </div>

        <div class="payment-content">
            <div id="card" class="content-section active">

                <div class="card-display">
                    <div class="card-header">
                        <div class="card-type">DEBIT CARD</div>
                        <div class="card-chip"></div>
                    </div>
                    <div id="card-number-display">4111 1111 1111 1111</div>
                    <div class="card-footer">
                        <div id="card-name-display">JOHN DOE</div>
                        <div class="visa-logo">VISA</div>
                    </div>
                </div>
                <div class="input-group">
                    <label for="card-number">Card Number</label>
                    <input type="text" id="card-number" value="4111 1111 1111 1111" required maxlength="19">
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label for="expiry">Expiry Date (MM/YY)</label>
                        <input type="text" id="expiry" value="12/26" required maxlength="5" placeholder="MM/YY">
                    </div>
                    <div class="input-group">
                        <label for="cvv">CVV</label>
                        <input type="text" id="cvv" value="123" required maxlength="3" placeholder="123">
                    </div>
                </div>
                <div class="input-group">
                    <label for="card-name">Name on Card </label>
                    <input type="text" id="card-name" value="{{userName}}" required>
                </div>
            </div>

            <div id="upi" class="content-section">
                <div class="upi-options">
                    <div class="upi-btn selected" data-app="gpay">
                        <img src="https://play-lh.googleusercontent.com/HArtbyi53u0jnqhnnxkQnMx9dHOERNcprZyKnInd2nrfM7Wd9ivMNTiz7IJP6-mSpwk"
                            alt="Google Pay">
                        GPay
                    </div>
                    <div class="upi-btn" data-app="phonepe">
                        <img src="https://play-lh.googleusercontent.com/6iyA2zVz5PyyMjK5SIxdUhrb7oh9cYVXJ93q6DZkmx07Er1o90PXYeo6mzL4VC2Gj9s=w240-h480-rw"
                            alt="PhonePe">
                        PhonePe
                    </div>
                    <div class="upi-btn" data-app="paytm">
                        <img src="https://play-lh.googleusercontent.com/vYnuetu-oxu95vRuQWokFveq7f_Qn3Pf-eGCfclgBTO9f4qwABZl4XrCA40YIolOb1SkynCto2drVd6wwnVl=w240-h480-rw"
                            alt="Paytm">
                        Paytm
                    </div>
                </div>

                <div class="qr-container">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=dummyupi@bank&pn=Merchant&am=4999&cu=INR"
                        alt="Dummy QR Code for UPI">
                    <p style="font-size:0.9em; color: #555;">Scan this QR code using your UPI app to pay.</p>
                    <p style="font-weight: 600; margin-top: 10px;">OR</p>
                </div>
                <div class="input-group">
                    <label for="upi-vpa">Enter UPI ID (VPA)</label>
                    <input type="text" id="upi-vpa" value="{{userName}}@ybl" placeholder="Ex: yourname@bankname"
                        required>
                </div>
            </div>

            <div id="netbanking" class="content-section">
                <div class="input-group">
                    <label for="bank-select">Select Your Bank</label>
                    <select id="bank-select">
                        <option value="" disabled selected>Choose a Bank</option>
                        <option value="sbi">State Bank of India</option>
                        <option value="hdfc">HDFC Bank</option>
                        <option value="icici">ICICI Bank</option>
                        <option value="pnb">Punjab National Bank</option>
                        <option value="axis">Axis Bank</option>
                        <option value="other">Other Banks</option>
                    </select>
                </div>
                <p style="font-size:0.9em; color:#555;">You will be securely redirected to your bank's website.</p>
            </div>
        </div>

        <button id="pay-button" class="pay-button" onclick="spay">Pay ‚Çπ{{price}}</button>
    </div>
</div>

<div id="success-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-button" onclick="closeModal()">&times;</span>
        <div class="success-icon">&#10003;</div>
        <h2>Payment Successful!</h2>
        <p>Your payment of **‚Çπ4,999** has been processed and confirmed.</p>
        <p style="font-weight: bold;">Transaction ID: **TXN-987654321**</p>
        <button class="pay-button" onclick="closeModal()">Done</button>
    </div>
</div>

<script>
    function closeModal() {
        document.getElementById("success-modal").style.display = "none";
        window.location.href = "http://localhost:3000/activities";
    }

    function spay() {
        // 1. Show the success modal
        document.getElementById("success-modal").style.display = "flex";

    }



    document.addEventListener('DOMContentLoaded', () => {
        const modal = document.getElementById("success-modal");
        const payButton = document.getElementById("pay-button");
        const methodButtons = document.querySelectorAll('.method-btn');
        const contentSections = document.querySelectorAll('.content-section');
        const upiAppButtons = document.querySelectorAll('.upi-btn');

        // Card Display Elements
        const cardNumberInput = document.getElementById('card-number');
        const cardNameInput = document.getElementById('card-name');
        const cardNumberDisplay = document.getElementById('card-number-display');
        const cardNameDisplay = document.getElementById('card-name-display');

        // --- 1. LIVE Card Display Update Logic ---
        function updateCardDisplay(inputElement, displayElement) {
            if (inputElement && displayElement) {
                let value = inputElement.value;
                if (inputElement.id === 'card-number') {
                    // Format card number with spaces every 4 digits
                    value = value.replace(/\s/g, '').replace(/(\d{4})/g, '$1 ').trim();
                }
                displayElement.textContent = value.toUpperCase() || displayElement.textContent;
            }
        }

        // Listen for input changes to update the card visual in real-time
        if (cardNumberInput && cardNumberDisplay) {
            cardNumberInput.addEventListener('input', () => updateCardDisplay(cardNumberInput, cardNumberDisplay));
            // Initialize the display with the dummy value on load
            updateCardDisplay(cardNumberInput, cardNumberDisplay);
        }
        if (cardNameInput && cardNameDisplay) {
            cardNameInput.addEventListener('input', () => updateCardDisplay(cardNameInput, cardNameDisplay));
            // Initialize the display with the dummy value on load
            updateCardDisplay(cardNameInput, cardNameDisplay);
        }

        // --- 2. Method Switching Logic ---
        methodButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetMethod = button.getAttribute('data-method');

                // Deactivate all buttons and content
                methodButtons.forEach(btn => btn.classList.remove('active'));
                contentSections.forEach(section => section.classList.remove('active'));

                // Activate selected button and content
                button.classList.add('active');
                document.getElementById(targetMethod).classList.add('active');
            });
        });

        // --- 3. UPI App Selection Logic ---
        upiAppButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Deactivate all UPI buttons
                upiAppButtons.forEach(btn => btn.classList.remove('selected'));
                // Activate the clicked button
                button.classList.add('selected');
            });
        });

        // --- 4. Pay Button and Modal Logic ---
        payButton.onclick = function () {
            // --- SIMULATION STEP: Show success pop-up ---
            modal.style.display = "flex"; // Use flex to center the modal
        }

        // --- 5. Close Modal when clicking outside ---
        window.onclick = function (event) {
            if (event.target == modal) {
                closeModal();
            }
        }
    });
</script>